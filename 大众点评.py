from selenium import webdriver
import time
import xlwt
import datetime
import random
from urllib import parse
driver = webdriver.Chrome()
# driver.minimize_window()
driver.get('https://www.dianping.com/')
driver.find_element_by_xpath('//*[@id="top-nav"]/div/div[2]/span[1]/a[1]').click()
print("扫码登陆")
time.sleep(10)
key_word = "美甲店"
key_word = parse.unquote(key_word)
print(key_word)

url_list=[]
# url_list=['http://www.dianping.com/shop/H54UbCIK557kJN2W', 'http://www.dianping.com/shop/H7HSqeIW2l7et4Q1', 'http://www.dianping.com/shop/k2mW3LkCZWVtvt01', 'http://www.dianping.com/shop/k1G2qYVYj7rMT2Bs', 'http://www.dianping.com/shop/k6q3231J9alphfQR', 'http://www.dianping.com/shop/k41686QB0dTNhkbm', 'http://www.dianping.com/shop/G16O4Wm8HqDTZ92p', 'http://www.dianping.com/shop/k4tSr7OUmY7wCaaQ', 'http://www.dianping.com/shop/H2Ha38uY3KAY419X', 'http://www.dianping.com/shop/kajHJzC1Sa5fFNu2', 'http://www.dianping.com/shop/FJHn2NZUHttEoDnL', 'http://www.dianping.com/shop/H4lN2yNjWtqclHfl', 'http://www.dianping.com/shop/ETYFafc9Bv98GAc1', 'http://www.dianping.com/shop/laxmw6a9swXixs6X', 'http://www.dianping.com/shop/k64iTHlRRSceDvZJ', 'http://www.dianping.com/shop/imAV18Tvjjgi1mbY', 'http://www.dianping.com/shop/H4Q2IG9fWT2XyHru', 'http://www.dianping.com/shop/imggeuBKqGxbDS33', 'http://www.dianping.com/shop/H3wKNafMNBH0UpRx', 'http://www.dianping.com/shop/H6dGAiNNLY9MwNUb', 'http://www.dianping.com/shop/k1ODH5I1wS6YVxGE', 'http://www.dianping.com/shop/kaoSi100YUqteURT', 'http://www.dianping.com/shop/G62UwstLSWtRVPgm', 'http://www.dianping.com/shop/G9lISBvkOFbtFyMr', 'http://www.dianping.com/shop/Ga3xRpLmqBHajlUk', 'http://www.dianping.com/shop/k3nYOCVReNhZYsSh', 'http://www.dianping.com/shop/H3xm5o2je4LI3OHo', 'http://www.dianping.com/shop/H84M5KyVSYgsSRQy', 'http://www.dianping.com/shop/k4gzdRihBVg0WTs5', 'http://www.dianping.com/shop/l5xHTYJiGSn3knMZ', 'http://www.dianping.com/shop/H8U7uV5yOCyPsSyp', 'http://www.dianping.com/shop/H2Ky19gXMM7dqwmU', 'http://www.dianping.com/shop/H7KXY3sDwDXHCSZM', 'http://www.dianping.com/shop/H1Z1rsXBzZUd3LPf', 'http://www.dianping.com/shop/G1Wej0hmFPYNdE6L', 'http://www.dianping.com/shop/laeMVPKT5qEKGyxR', 'http://www.dianping.com/shop/H76E8R3aRKsGEWAq', 'http://www.dianping.com/shop/k4CSNQGQyxbJhAMs', 'http://www.dianping.com/shop/H5wkJzivQ1sP8Biq', 'http://www.dianping.com/shop/H6V5qsywYYbmSXwc', 'http://www.dianping.com/shop/l2qX9u7f4KK3Lqd8', 'http://www.dianping.com/shop/k7RufFxxnNeCiztn', 'http://www.dianping.com/shop/kai2kYZ00wbipezu', 'http://www.dianping.com/shop/H33YklgF4tdfSLaY', 'http://www.dianping.com/shop/G9EYrjFLRzwI3ECs', 'http://www.dianping.com/shop/H8cowSL4x1Bdewem', 'http://www.dianping.com/shop/G8xNHdwT8nkmtbYk', 'http://www.dianping.com/shop/k6tS6t5bCOKf1y7d', 'http://www.dianping.com/shop/k8WJ6qdnfDTFvost', 'http://www.dianping.com/shop/H8mouMxY9357U7DV', 'http://www.dianping.com/shop/latbklddvWh67uWR', 'http://www.dianping.com/shop/k1DtbFykhwZ0aHgS', 'http://www.dianping.com/shop/l4kmbMhsAu34d9wy', 'http://www.dianping.com/shop/k8W2FW716N3FnJPe', 'http://www.dianping.com/shop/G7s5DGZqPAlSHfyD', 'http://www.dianping.com/shop/k3VyfP56eAJm0wLN', 'http://www.dianping.com/shop/k7j5W4qdEasRi8SW', 'http://www.dianping.com/shop/k15JLTyehPjmrPBx', 'http://www.dianping.com/shop/l7T8KjUgAREMBFSY', 'http://www.dianping.com/shop/k8r3kFh1e07VhBFU', 'http://www.dianping.com/shop/FA53jwSa0f35Po0f', 'http://www.dianping.com/shop/l7pzDZUIp22V6Ku5', 'http://www.dianping.com/shop/H3OchGkaw2pbTdIl', 'http://www.dianping.com/shop/H5HGvNviBadwdbmn', 'http://www.dianping.com/shop/H28CM1RhPxqBshWy', 'http://www.dianping.com/shop/GavHAlYzN2QaDT7o', 'http://www.dianping.com/shop/l3Z4KA0w7ITecqFz', 'http://www.dianping.com/shop/FhH8AVUKqlmGiylR', 'http://www.dianping.com/shop/k9VFSLBzlB3YgC0W', 'http://www.dianping.com/shop/l9e4UcJc7gwbGPrZ', 'http://www.dianping.com/shop/kaMPmRtBT7V6lBhS', 'http://www.dianping.com/shop/k8sicG1Xaom5jbMQ', 'http://www.dianping.com/shop/jxQeOOLZLD5o7IU1', 'http://www.dianping.com/shop/jVvpoMKqAokwamSL', 'http://www.dianping.com/shop/H3pSA1XgD7jAkxA6', 'http://www.dianping.com/shop/G1E3aInwyS1EY5TA', 'http://www.dianping.com/shop/l4ZkhT8mitDFMOhU', 'http://www.dianping.com/shop/k6adPiqfWFL1cudh', 'http://www.dianping.com/shop/laxeVtvewBYt0rft', 'http://www.dianping.com/shop/l55exhJUFqSYF9XC', 'http://www.dianping.com/shop/k4BPx7cVAH1C94Qt', 'http://www.dianping.com/shop/G4hBPBcagMCyxVOv', 'http://www.dianping.com/shop/G5KywaMYlep5fQyU', 'http://www.dianping.com/shop/laOElcSBoTtWZq6e', 'http://www.dianping.com/shop/H227KWhpnUZNB7Hk', 'http://www.dianping.com/shop/EUiEfA2BG1I09r3N', 'http://www.dianping.com/shop/G3PUg6mo3qfHua1I', 'http://www.dianping.com/shop/l3ZEVkks95uwgUxj', 'http://www.dianping.com/shop/k7T9KRPwfec0Gm7R', 'http://www.dianping.com/shop/lavDkOVlf17cXcvj', 'http://www.dianping.com/shop/H1EzN0ktWFDN24xe', 'http://www.dianping.com/shop/l5m8L5mOSFIWeK3Z', 'http://www.dianping.com/shop/G5OkErS5pKToQ0rq', 'http://www.dianping.com/shop/k51UHPxBUSwe2f2m', 'http://www.dianping.com/shop/l3qfZrWEUWZeV8vq', 'http://www.dianping.com/shop/lap6SWZTpYuc61sC', 'http://www.dianping.com/shop/G4L6Ct7aiOC6ldtF', 'http://www.dianping.com/shop/H2YV2YYfXrUKM0XG', 'http://www.dianping.com/shop/joBMiIK03HTVQzYR', 'http://www.dianping.com/shop/l4RMthW9Wmu5XD01', 'http://www.dianping.com/shop/lasWRoUEIA6OM8PM', 'http://www.dianping.com/shop/k75pXxBmgfx43wV3', 'http://www.dianping.com/shop/l9nqaihMrXyPn5C6', 'http://www.dianping.com/shop/Ebpwk3krWVQlOGo0', 'http://www.dianping.com/shop/Ga5kfuwcPsLS2UMs', 'http://www.dianping.com/shop/H2i0j6ccHH6hapor', 'http://www.dianping.com/shop/H6RhETn9YARvSdNL', 'http://www.dianping.com/shop/H1Cc6HDlplpYA4Gn', 'http://www.dianping.com/shop/HapwQGBB1GKSC6gL', 'http://www.dianping.com/shop/juICstHHEOC7L46i', 'http://www.dianping.com/shop/k5EFR4V31x7tJuuB', 'http://www.dianping.com/shop/HaNH2BnxkW2Nk4hS', 'http://www.dianping.com/shop/l5tVKAC45k3I9QnN', 'http://www.dianping.com/shop/k6VHuexYSGGK2zCT', 'http://www.dianping.com/shop/jp7NSt23KGR71How', 'http://www.dianping.com/shop/l1oOGDnghBCUnrv5', 'http://www.dianping.com/shop/l6Ac2dK6ceb24kgD', 'http://www.dianping.com/shop/k8b00EtgZaad2z5k', 'http://www.dianping.com/shop/l67Z9MuRbU9vY807', 'http://www.dianping.com/shop/G9U0J8omRksBUY74', 'http://www.dianping.com/shop/G6BpWtvE5j4sRrnW', 'http://www.dianping.com/shop/l3q95NAfY6HOCP3F', 'http://www.dianping.com/shop/k7ahhoWgWEOzlwUA', 'http://www.dianping.com/shop/l7koNCKBfKRLC9pD', 'http://www.dianping.com/shop/G6pzOCDvOB2vQE3d', 'http://www.dianping.com/shop/H6BwN3CxkUQSi85e', 'http://www.dianping.com/shop/H1R5X7BeExbg0NjI', 'http://www.dianping.com/shop/laj849Vo9THfibHG', 'http://www.dianping.com/shop/l9xFFC3iQUxm0CTo', 'http://www.dianping.com/shop/laK6RJzO86J1Zjrc', 'http://www.dianping.com/shop/H8VRgN0uvz5zaqtt', 'http://www.dianping.com/shop/l4XjvzjbUgTEs8xu', 'http://www.dianping.com/shop/l1IdnQItKzjbpWwR', 'http://www.dianping.com/shop/l9AdUaHA5qlLwJ1m', 'http://www.dianping.com/shop/G8inNwEOeEkvGNBx', 'http://www.dianping.com/shop/H294RM9ChqclmXMr', 'http://www.dianping.com/shop/H3yVezHzQgAQrZ75', 'http://www.dianping.com/shop/l9LXHetKRXROEtqa', 'http://www.dianping.com/shop/G8b1wo7QPOphB0z4', 'http://www.dianping.com/shop/G8TM09FIGzy0NsRe', 'http://www.dianping.com/shop/H9CWk4CvRtyjY7lx', 'http://www.dianping.com/shop/k6cKVBjR6utKKAMg', 'http://www.dianping.com/shop/k3ZBXVqzYna4mpaB', 'http://www.dianping.com/shop/G7X3m5MJNIvGXCdq', 'http://www.dianping.com/shop/G9nxGzteICN6jiWJ', 'http://www.dianping.com/shop/l7J3hsJxXt0rZwdT', 'http://www.dianping.com/shop/k5EVYGItwsi2cNx3', 'http://www.dianping.com/shop/i199MMykp1vGYaLM', 'http://www.dianping.com/shop/k45BTk3JYktrQsUx', 'http://www.dianping.com/shop/G6hCmUFlUhO1MJw7', 'http://www.dianping.com/shop/H7UMjSy607yCRytd', 'http://www.dianping.com/shop/kagwYsXDQcdep6gq', 'http://www.dianping.com/shop/l865SyBYrnfS3YX7', 'http://www.dianping.com/shop/G8YHxG2svVRWHKa6', 'http://www.dianping.com/shop/H15gQieu7LbLhaGH', 'http://www.dianping.com/shop/l5N5bboObnTxDHim', 'http://www.dianping.com/shop/ka176LWAIzHZfPiN', 'http://www.dianping.com/shop/k8o79r7HdicGK6Js', 'http://www.dianping.com/shop/l8zppn2rzUAnlGGC', 'http://www.dianping.com/shop/G9uN9fCTbpe1RZ0k', 'http://www.dianping.com/shop/k7zMvE0MDUCMHsfm', 'http://www.dianping.com/shop/l63hnY1MoFhtH5ol', 'http://www.dianping.com/shop/G6YOgofX6SqBCQRT', 'http://www.dianping.com/shop/H3Cp2t0hr4TAMhJQ', 'http://www.dianping.com/shop/G3zEZT2c4ACN6YLb', 'http://www.dianping.com/shop/k2lHj7Hsldb6Y4LE', 'http://www.dianping.com/shop/laNZFbrjqsYJTNJD', 'http://www.dianping.com/shop/H2gx0sw80RH2029n', 'http://www.dianping.com/shop/l6cvYVDDXrvhsPO7', 'http://www.dianping.com/shop/G3FZacAJpmas288j', 'http://www.dianping.com/shop/l85f4c3S8hyG7SvZ', 'http://www.dianping.com/shop/l9rpJ6xNKaLJH7o2', 'http://www.dianping.com/shop/iYE8N4zy8qykOiRp', 'http://www.dianping.com/shop/GaGPtxPTaVpvrdpF', 'http://www.dianping.com/shop/lac1FdxmiHNCFYcQ', 'http://www.dianping.com/shop/H4wvyJFgqSMQPzDH', 'http://www.dianping.com/shop/H1hrxeYK5EBRN2PP', 'http://www.dianping.com/shop/FX58kurpVz4NkAMR', 'http://www.dianping.com/shop/G66jNfvP5iXarkAh', 'http://www.dianping.com/shop/G1eDN3CQ12Kkgd1w', 'http://www.dianping.com/shop/l8KXnSwVBPukzRL1', 'http://www.dianping.com/shop/Gay3iEJvdDJGT9Y8', 'http://www.dianping.com/shop/l2cwnLOZ24N15eqa', 'http://www.dianping.com/shop/k9vesDyjRUfVsuKi', 'http://www.dianping.com/shop/l8bpVjUXn6DsntnD', 'http://www.dianping.com/shop/G6K546MmApEUDVfe', 'http://www.dianping.com/shop/i7lwPJzJSBJyz3jF', 'http://www.dianping.com/shop/Ha955OCp0kLDJgVo', 'http://www.dianping.com/shop/k2EJnvtKftoPyHa1', 'http://www.dianping.com/shop/FsITblSEXYZDjIWg', 'http://www.dianping.com/shop/G6KTxzzglfW4JecS', 'http://www.dianping.com/shop/H9vl1TDmejYLQhqY', 'http://www.dianping.com/shop/kaQlizUudkRNXdNC', 'http://www.dianping.com/shop/k8y3iBa5jxG9ArDz', 'http://www.dianping.com/shop/G64FgrJfPeAs5jXf', 'http://www.dianping.com/shop/i7h7is9l3RnJVPDR', 'http://www.dianping.com/shop/kaL3yEc2NnZabCTd', 'http://www.dianping.com/shop/l4LFGLOyNE6drDGJ', 'http://www.dianping.com/shop/k7mG0VnrDvx9vtQv', 'http://www.dianping.com/shop/k8xXegAy0SrPWUDP', 'http://www.dianping.com/shop/k5vc8wXWrJE7krbq', 'http://www.dianping.com/shop/G7J5zYMMxqjrpkY9', 'http://www.dianping.com/shop/G68H5CV0YuzY4ELl', 'http://www.dianping.com/shop/FDs63GWQOr0z7aky', 'http://www.dianping.com/shop/k9XpehZyKABBwFMy', 'http://www.dianping.com/shop/G5TSlt2jmn6De1dB', 'http://www.dianping.com/shop/laE5lEaUZTb3dHBw', 'http://www.dianping.com/shop/jaSO7ICeXSvveaTR', 'http://www.dianping.com/shop/H1lSj5k6J7OTcT1R', 'http://www.dianping.com/shop/H3Pkg6GJ7P3qXysB', 'http://www.dianping.com/shop/k6w6B102LDgyM8aU', 'http://www.dianping.com/shop/l7UKvgaEwuzYvbZB', 'http://www.dianping.com/shop/k2Oqft2s8uUeQTpM', 'http://www.dianping.com/shop/G7sx0aLb2GPeejdZ', 'http://www.dianping.com/shop/G41mR0PEM0T826j1', 'http://www.dianping.com/shop/G1lfL74PYR2jyDU6', 'http://www.dianping.com/shop/l4puOYMXhbPLRAGz', 'http://www.dianping.com/shop/G3MQive0iaErtB6X', 'http://www.dianping.com/shop/H91pXKCpugDYXWNW', 'http://www.dianping.com/shop/H1dOSjiHTCnUreIT', 'http://www.dianping.com/shop/H1lSj5k6J7OTcT1R', 'http://www.dianping.com/shop/l1snmnBqrrt6wEkB', 'http://www.dianping.com/shop/i9ICY7EdD9ZUkeTL', 'http://www.dianping.com/shop/H1rZd4NtwHzH1ftZ', 'http://www.dianping.com/shop/k6BF2g9pEYyNNB6O', 'http://www.dianping.com/shop/k7fnGRJMzMWUZFIQ', 'http://www.dianping.com/shop/H6ZzYMGVqgcHi8In', 'http://www.dianping.com/shop/H36lUh6TZevbYba2', 'http://www.dianping.com/shop/G4ObquYM7wzF6oS1', 'http://www.dianping.com/shop/H2wfaYzpNi73ul8b', 'http://www.dianping.com/shop/H91pXKCpugDYXWNW', 'http://www.dianping.com/shop/H7HDLW0ZVROPnNgL', 'http://www.dianping.com/shop/H5sgAHBvIrOESLSU', 'http://www.dianping.com/shop/H2nyatmCXGOLt4ED', 'http://www.dianping.com/shop/H2wfaYzpNi73ul8b', 'http://www.dianping.com/shop/H7HDLW0ZVROPnNgL', 'http://www.dianping.com/shop/H6ZzYMGVqgcHi8In', 'http://www.dianping.com/shop/jvxyXVmXzWUj0lZD', 'http://www.dianping.com/shop/l6HYFcQKOTQ6BrQb', 'http://www.dianping.com/shop/G3jdtW93iMPefy9k', 'http://www.dianping.com/shop/k2do0nHUFlBKaAYj', 'http://www.dianping.com/shop/H8ekvXD2WESO1QOm', 'http://www.dianping.com/shop/H91pXKCpugDYXWNW', 'http://www.dianping.com/shop/k3i8kXzyXIzkBDPT', 'http://www.dianping.com/shop/H1SUsJk59nHr5PDz', 'http://www.dianping.com/shop/k9N6hQ0QkBMgaJQG', 'http://www.dianping.com/shop/l9whrBycp9iGFj48', 'http://www.dianping.com/shop/k6FpCocDJSAFi0Ug', 'http://www.dianping.com/shop/l614x85L1XOpUZ6X', 'http://www.dianping.com/shop/l6Ik9s4S8KhHcm8k', 'http://www.dianping.com/shop/H8ekvXD2WESO1QOm', 'http://www.dianping.com/shop/H4OgaVIPodP2Pv7H', 'http://www.dianping.com/shop/G2Eq8CAhFLoEBsvS', 'http://www.dianping.com/shop/HaFHs1ztAyCZfcDc', 'http://www.dianping.com/shop/l1G8rY5mMqL5XAXB', 'http://www.dianping.com/shop/H1dOSjiHTCnUreIT', 'http://www.dianping.com/shop/l5WUxSpfzTio8y8O', 'http://www.dianping.com/shop/G6UmqlQ9WJI0mq9m', 'http://www.dianping.com/shop/ka4Tpxjg1ExzA7cD', 'http://www.dianping.com/shop/G9EgRDr35ag855vk', 'http://www.dianping.com/shop/G3jdtW93iMPefy9k', 'http://www.dianping.com/shop/k7ujxFabjQK5iVmg', 'http://www.dianping.com/shop/igzuE5S57v4teJm5', 'http://www.dianping.com/shop/k7BcwCvhVoUZoXXa', 'http://www.dianping.com/shop/ka4Tpxjg1ExzA7cD', 'http://www.dianping.com/shop/igzuE5S57v4teJm5', 'http://www.dianping.com/shop/k7BcwCvhVoUZoXXa', 'http://www.dianping.com/shop/jOWBG3Kpi3uaiTKj', 'http://www.dianping.com/shop/H3Fdu1zAJblQ07Ol', 'http://www.dianping.com/shop/H8aIe9KXdQlyHUUF', 'http://www.dianping.com/shop/H2uCx1tkPsLUV2bB', 'http://www.dianping.com/shop/G6h1KbrIpdk1Qord', 'http://www.dianping.com/shop/G99hDIh8lWvwnTwm', 'http://www.dianping.com/shop/H76n6vzHUFmXsS3G', 'http://www.dianping.com/shop/G6MesqOoRF6GmSFr', 'http://www.dianping.com/shop/k48HoAHifGhkYF3j', 'http://www.dianping.com/shop/H4Qa3bWxplciiGKx', 'http://www.dianping.com/shop/G5hbGS4efntZAw5l', 'http://www.dianping.com/shop/l5Voip98yKzopiC7', 'http://www.dianping.com/shop/EOOf9jgBkZjUvbcR', 'http://www.dianping.com/shop/G3ialmYhfpBBBuQJ', 'http://www.dianping.com/shop/k8j7KIn1JZWt0j99', 'http://www.dianping.com/shop/l3iTnTRwVWnr2DIY', 'http://www.dianping.com/shop/G3z0QfcMEMCtWyPc', 'http://www.dianping.com/shop/l1oijKEztQIU7p2L', 'http://www.dianping.com/shop/l2HubFhPUCLjznHr', 'http://www.dianping.com/shop/G9XuFOJt6F2hpC69', 'http://www.dianping.com/shop/H39BULWGdpyBt3OU', 'http://www.dianping.com/shop/F4oQ3x4sP1xyJz4M', 'http://www.dianping.com/shop/G2YBoq2ZTn3FsxLH', 'http://www.dianping.com/shop/l4AZRTPlMqCZBpKA', 'http://www.dianping.com/shop/H3rYAlvvFfRe08iM', 'http://www.dianping.com/shop/l719FlHFZXdq9rZz', 'http://www.dianping.com/shop/H5VkHroxLjH8ARjk', 'http://www.dianping.com/shop/l719FlHFZXdq9rZz', 'http://www.dianping.com/shop/laO4sL26c4h7OMG4', 'http://www.dianping.com/shop/H5VkHroxLjH8ARjk', 'http://www.dianping.com/shop/k2vgKXsG0EhHK3Rt', 'http://www.dianping.com/shop/H2I3RfN96ZfJPkgo', 'http://www.dianping.com/shop/H34JSMvCHocYwFdH', 'http://www.dianping.com/shop/H9jYXLymx5yErIC7', 'http://www.dianping.com/shop/k8uXJK8clOBIEnpI', 'http://www.dianping.com/shop/l5HvZQm2k1l3LPaw', 'http://www.dianping.com/shop/l6KKJjEyJzFnnIlU', 'http://www.dianping.com/shop/G96EUg2yaP2TzN9I', 'http://www.dianping.com/shop/k6DEcXgcgIMWZ2hH', 'http://www.dianping.com/shop/l6ozuX89NPi9VcXG', 'http://www.dianping.com/shop/l2G6kMeNXkSGhOPs', 'http://www.dianping.com/shop/G5PWduojrtYMIfvR', 'http://www.dianping.com/shop/H8BL0nJyssNWTDI4', 'http://www.dianping.com/shop/l6ozuX89NPi9VcXG', 'http://www.dianping.com/shop/F4oQ3x4sP1xyJz4M', 'http://www.dianping.com/shop/G2jUIoPpfRegZCWQ', 'http://www.dianping.com/shop/G5R2T2ff6DdpgEzV', 'http://www.dianping.com/shop/l1oijKEztQIU7p2L', 'http://www.dianping.com/shop/k8PkJuHddpNDPgUo', 'http://www.dianping.com/shop/k9vVPzS5A1ZPJG0M', 'http://www.dianping.com/shop/H8tE0XkwrAh80SwI', 'http://www.dianping.com/shop/H4c8CkGLqmsiUC6b', 'http://www.dianping.com/shop/G9ZwAswX85IlQOZV', 'http://www.dianping.com/shop/G1PhVBRj6Sn5Pige', 'http://www.dianping.com/shop/l4SDAviHBzugfzfA', 'http://www.dianping.com/shop/l4kqouRQ4WxDQQ76', 'http://www.dianping.com/shop/H48Js5DbAFu6kywi', 'http://www.dianping.com/shop/H4kpVRAf2JvBzas3', 'http://www.dianping.com/shop/k7FLszk2j6Sr7YnP', 'http://www.dianping.com/shop/H5zly4jBsnPvcyth', 'http://www.dianping.com/shop/k3TR131HeyVBJDcl', 'http://www.dianping.com/shop/l6ozuX89NPi9VcXG', 'http://www.dianping.com/shop/G1PhVBRj6Sn5Pige', 'http://www.dianping.com/shop/H48Js5DbAFu6kywi', 'http://www.dianping.com/shop/k5P70HZCe6ZEY1DJ', 'http://www.dianping.com/shop/G2YBoq2ZTn3FsxLH', 'http://www.dianping.com/shop/G26dr9T8B0D1g1T9', 'http://www.dianping.com/shop/k80SVhKu2iVERSpG', 'http://www.dianping.com/shop/l5EbFKrumDUjKmpb', 'http://www.dianping.com/shop/k8WK9mzZQce7Wi6b', 'http://www.dianping.com/shop/H7qAOK5qIoTHWKF0', 'http://www.dianping.com/shop/G96EUg2yaP2TzN9I', 'http://www.dianping.com/shop/k7ujxFabjQK5iVmg', 'http://www.dianping.com/shop/G9XuFOJt6F2hpC69', 'http://www.dianping.com/shop/k5xK551fzd1fjhzR', 'http://www.dianping.com/shop/H8ekvXD2WESO1QOm', 'http://www.dianping.com/shop/H7aGyTvYU8As7ykF', 'http://www.dianping.com/shop/HaFHs1ztAyCZfcDc', 'http://www.dianping.com/shop/H1lSj5k6J7OTcT1R', 'http://www.dianping.com/shop/l4XU0Mb83Xmtpl9Y', 'http://www.dianping.com/shop/G5cFPMI7n582q30t', 'http://www.dianping.com/shop/l2HubFhPUCLjznHr', 'http://www.dianping.com/shop/G33tKm8CE38EcSkI', 'http://www.dianping.com/shop/F1Wltqrk28PMQGKB', 'http://www.dianping.com/shop/H3cFnLB37KP4ZYkl', 'http://www.dianping.com/shop/G9SBVUZ4yhk1zMLP', 'http://www.dianping.com/shop/k9FEsRHV7082vjLr', 'http://www.dianping.com/shop/l8K3KSnd1xs5KwhW', 'http://www.dianping.com/shop/H4kBOvUjeXazWujl', 'http://www.dianping.com/shop/lapUiYFhPfJ4FzOv', 'http://www.dianping.com/shop/k5fU6slMEklOW5Z6', 'http://www.dianping.com/shop/k6XuWQ33vdgJmwUr', 'http://www.dianping.com/shop/H3Btv2WMOK7dMq7q', 'http://www.dianping.com/shop/HatEPM1jRFPNPPTK', 'http://www.dianping.com/shop/Ha0s3f2gQzKPxXAl', 'http://www.dianping.com/shop/H8QrEMYRiSB6TjTz', 'http://www.dianping.com/shop/H7tJvrfsIKDC1kfH', 'http://www.dianping.com/shop/G3YvZvHT1kycMb6G', 'http://www.dianping.com/shop/H5tdtKRxOKIuLbfW', 'http://www.dianping.com/shop/H5ZH55QO8lvukKVz', 'http://www.dianping.com/shop/G5pUejj0wCNWJ54S', 'http://www.dianping.com/shop/l636WG90LfKkmNN1', 'http://www.dianping.com/shop/HaV5nRODGvLs8LGp', 'http://www.dianping.com/shop/H6TU3OfELdy3rtrR', 'http://www.dianping.com/shop/G7hlQGjSXAUlppq5', 'http://www.dianping.com/shop/H3Fdu1zAJblQ07Ol', 'http://www.dianping.com/shop/G6bIiWsYLD4R2POo', 'http://www.dianping.com/shop/k9t72xYLZgCAmq37', 'http://www.dianping.com/shop/H8qSjYnkdeglI5CE', 'http://www.dianping.com/shop/H7Lh6TE2Kw1lSSu8', 'http://www.dianping.com/shop/H9jYXLymx5yErIC7', 'http://www.dianping.com/shop/H60oukY9ICue7sXy', 'http://www.dianping.com/shop/G1mmSahXCczEtvaP', 'http://www.dianping.com/shop/G6fDyVlh0DUjFlG1']
print("获取城市店铺列表")
for page in range(1,51):
    u = f'https://www.dianping.com/search/keyword/1/0_{key_word}/p{page}'
    driver.get(u)
    a = driver.find_element_by_class_name('shop-list').find_elements_by_tag_name('li')
    for i in a:
        b=i.find_element_by_class_name('pic').find_element_by_tag_name('a').get_attribute('href')
        url_list.append(b)
print('len(url_list)',len(url_list))
print(url_list)
excel = xlwt.Workbook(encoding='utf-8',style_compression=0)
table = excel.add_sheet('1',cell_overwrite_ok=True)
table.write(0,1,"店铺名")
table.write(0,2,"评分")
table.write(0,3,"评论数")
table.write(0,4,"地址")
table.write(0,5,"创立时间")
num = 1
for i in url_list:
    t=random.randint(5,20)
    driver.get(i)
    time.sleep(t)
    store_name = driver.find_element_by_class_name('shop-name').text
    store_name = store_name.split("分店")[0]
    table.write(num,1,store_name)
    print('店铺名:',store_name)
    time.sleep(t)
    s=driver.find_element_by_class_name('brief-info')
    stars=s.find_elements_by_tag_name('span')[0].get_attribute('class').split('str')[1]
    table.write(num,2,stars)
    print('星级:',stars)
    time.sleep(t)
    c=s.find_elements_by_tag_name('span')[1].text.split('条')[0]
    c=c.text.split('条')[0]
    table.write(num,3,c)
    print('评论数:',c)
    time.sleep(t)
    address=driver.find_element_by_xpath('/html/body/div[3]/div/div[1]/div[1]/div[2]/div[2]/div[2]').text
    table.write(num,4,address)
    print('地址:',address)
    time.sleep(t)
    found_date = driver.find_element_by_class_name('con').text
    found_date = found_date.split("时间")[1].split("商户")[0]
    table.write(num,5,found_date)
    print(f"sleep{t}\t创立时间:",found_date)
    time.sleep(t)
    print("\n")
    num = num+1
    excel.save(f"D:/Desktop/大众点评.xls")
driver.quit()

