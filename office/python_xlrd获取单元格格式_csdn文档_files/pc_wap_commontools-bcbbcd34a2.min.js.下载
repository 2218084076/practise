$(function(){function isInApp(){return!!window.navigator.userAgent.toLowerCase().match(/(csdn)/i)||!!isApp}function getClass(e){if(void 0!==typeof e&&null!==e&&""!==e)return e=e.toLowerCase(),class_name="hl-1",class_name}function isEmpty(e){return void 0===e||null===e||""===e}function mergeKeyword(e,t){isEmpty(t)||(t=t.toLowerCase().replace(/(^\s*)|(\s*$)/g,""),isEmpty(t)||(t.indexOf(" ")>0?$.each(t.split(/ +/g),function(t,n){mergeKeyword(e,n)}):"..."!==t&&t.length>1&&"&nbsp;"!==t&&"csdn"!==t&&"||"!==t&&(e[t]=0)))}function getKeyword(e){var t={};keyword=e.join(" "),mergeKeyword(t,keyword);var n=Object.keys(t);return n.sort(function(e,t){return t.length-e.length}),n}function hlDocument(keyword_list,document){for(var body=document.html(),htmlBody="",textChildrenArr=document.context.childNodes,idx=0;idx<textChildrenArr.length;idx++){var item=textChildrenArr[idx];if("#text"===item.nodeName){var curText=item.textContent.replace(/</gi,"&lt;"),regex=eval("/"+keyword_list.join("|")+"/ig"),hasHighlight=!1;curText=curText.replace(regex,function(e){var t=e.toLowerCase(),n="https://so.csdn.net/so/search?q="+encodeURIComponent(e);n=isInApp()?"csdnapp://app.csdn.net/search/searchRoot?keyword="+encodeURIComponent(e)+"&t=blog&u="+username:n;var i='{"spm":"1001.2101.3001.7020","dest":"'+n+'"}';return cache[t]>=1||preHlKeyword===t||hasHighlight?e:(hasHighlight=!0,cache[t]=cache[t]?cache[t]+1:1,preHlKeyword=t,isInApp()?'<a data-href="'+n+'" class="app-hl hl '+getClass(t)+'" data-report-click='+i+">"+e+"</a>":'<a href="'+n+'" target="_blank" class="hl '+getClass(t)+'" data-report-view='+i+" data-report-click="+i+">"+e+"</a>")}),htmlBody+=curText}else htmlBody+=item.outerHTML}document[0].innerHTML=htmlBody,isInApp()||window.csdn.report.viewCheck()}function appClickFun(){$("a.app-hl").off("click"),$("a.app-hl").click(function(e){e.preventDefault();var t=$(this).data("href"),n=$(this).attr("data-report-click"),i={trackingInfo:n,action:"app_blog_highlight"},o={url:t};isAndroid&&(window.jsCallBackListener.csdntrackevent(JSON.stringify(i)),window.jsCallBackListener.csdnjumpnewpage(JSON.stringify(o))),isiOS&&(window.webkit.messageHandlers.csdntrackevent.postMessage(JSON.stringify(i)),window.webkit.messageHandlers.csdnjumpnewpage.postMessage(JSON.stringify(o)))})}function initHighlight(){window.keyword_list_init=!0,$.ajax({type:"GET",url:"https://redisdatarecall.csdn.net/recommend/get_head_word?bid=blog-"+articleId,dataType:"json",timeout:2e3,xhrFields:{withCredentials:!0},success:function(e){if(200==e.status&&e.content){var t=getKeyword(e.content);if(void 0===t||0===t.length)return;window.keyword_list=t;var n=$("#content_views").find("p,h1,h2,h3,h4,h5,h6");window.keyword_list_doms=n,$.each(n,function(e,n){var n=$(n);hlDocument(t,n)}),isInApp()&&appClickFun()}}})}var id=1,cache={},preHlKeyword="",isApp=!!window.isApp&&window.isApp,u=navigator.userAgent,isAndroid=u.indexOf("Android")>-1||u.indexOf("Adr")>-1,isiOS=!!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),showHeadWord=void 0!==window.showHeadWord&&window.showHeadWord;showHeadWord&&initHighlight()}),function(){function e(){return!!window.navigator.userAgent.toLowerCase().match(/(phone|pad|pod|iphone|ipod|ios|ipad|android|mobile|blackberry|iemobile|mqqbrowser|juc|fennec|wosbrowser|browserng|webos|symbian|windows phone)/i)}function t(){return!!window.navigator.userAgent.toLowerCase().match(/(csdn)/i)}function n(){var n=null;n=e()?document.querySelectorAll('[class^="container-fluid container-fluid-flex container-"]'):t()?document.querySelectorAll('[class^="recommend_item type_"]'):document.querySelectorAll('[class^="recommend-item-box type_"]'),null!==n&&n.length<=5&&$.get("https://statistic.csdn.net/blog/recommend?count="+n.length+"&articleId="+articleId)}n()}();